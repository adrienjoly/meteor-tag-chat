<template name="layout">
  {{> loginButtons align="right" }}
  {{> yield}}
</template>

<!-- common/shared templates -->

<template name="loginPage">
  please login
</template>

<template name="disculink">
  <a href="/chatroom/{{_id}}"
     class="discushape new {{#if isSelected}}selected{{/if}}"
     data-uid="{{_id}}"
     data-tags="{{tagsOrId}}"
     title="{{tagsOrId}}">
    <p>
      {{cleanTags}}
      {{#if threadNotifs.count}}<span>{{threadNotifs.count}}</span>{{/if}}
    </p>
  </a>
</template>

<!-- home page (after login) -->

<template name="home">
  <div id="mainpane">
    <h1><a href="/">Discuthing</a></h1>
    <form id="mytagsForm">
      What are you about?
      {{#if currentUser }}
      <input type="text" id="mytags" placeholder="add a topic..." value="{{mytagsStr}}" data-role="tagsinput">
      {{/if}}
    </form>
    <p id="pitch">Have bits of talk with anyone sharing common interests with you at a specific moment. Select topics and see who's about it too. Shape your entourage, find people who care about the same things, at the same moment. Jump in, talk to someone or be talked to. Share moods, hobbies, ideas, travels, services...</p>
  {{#if currentUser }}
    <h2>Users:</h2>
    <ul>
    {{#each chatrooms}}
      <li>{{> disculink}}</li>
    {{/each}}    
    </ul>
  {{else}}
    {{#if loggingIn }}
      logging in...
    {{else}}
      <a class="login-link" href="#">please login</a>
    {{/if}}
  {{/if}}
  </div>
  {{#if selectedThread}}
  <div id="chatpane">
    {{> chatroom}}
  </div>
  {{/if}}
</template>

<!-- chat room page -->

<template name="chatroom">
  <h1>User: {{otherUser.tagsOrId}}</h1>
  <p>Message: <input type="text" id="message"></p>
  {{#each messages}}
    <strong>{{name}}:</strong> {{message}}<br>
  {{/each}}
</template>
